# Тесты лабы 1.2 по ЭВМ

## Тесты людей из ИТМО
Чтобы распарсить тесты просто запустите `python3 parse_tests.py`, но в целом не советую так делать, т.к. там дофига директорий будет создаваться, лучше использовать скрипт для запуска (`./itmo_tests/run.py`), потом выцеплять пару тестов, которые упали и на них запускаться
Также не все тесты в `./itmo_tests/` корректные, но вроде большинство норм
Чет почему то тесты медленно через `Makefile` запускаются, для запуска юзайте скрипт `./itmo_tests/run.py`. Там нужно выставить строковую переменную path_to_exe внутри файла - это путь до вашего скомпилированного решения

## Способ использования:

Можете вызвать `make help`, но тут базово пропишу

```bash
EXECUTABLE=./ваша_программа make test                                      # Запустить все тесты (показывать только упавшие)
EXECUTABLE=./ваша_программа make test-verbose                              # Запустить все тесты (показывать все результаты)
EXECUTABLE=./ваша_программа make test-single TEST=test/username/имя_теста  # Запустить один конкретный тест
make clean                                                                 # Очистить временные файлы
```
Или можете просто определить переменную окружения `EXECUTABLE` и отдельно при каждом запуске ее не вводить:
```bash
export EXECUTABLE=./ваша_программа
make test
make test-verbose
make test-single TEST=tests/username/имя_теста
```
Переменные окружения:

`EXECUTABLE` — Путь к исполняемому файлу для тестирования (по умолчанию: ./main)

`COMPARATOR` — Путь к скрипту для сравнения выводов (по умолчанию: python3 compare.py)

`FILTER` — Регулярное выражение для фильтрации тестов по имени (по умолчанию: .* - подходят все тесты)

Необходимые файлы:

`compare.py` — Скрипт для сравнения выходных данных (должен находиться в текущей директории)

Примечание:

Во время выполнения тестов создается временная директория `./.temp` для кроссплатформенной совместимости. Она автоматически удаляется после завершения тестов, но можно также использовать `make clean` для ручной очистки.

## Структура теста:
Каждый тест должен располагаться в папке tests/username/<имя_теста>/ и содержать:

in.txt (входные данные)

out.txt (ожидаемые выходные данные)

## Примеры:

### Основные команды:
```bash
EXECUTABLE=./my_program make test
EXECUTABLE=python3 my_script.py make test
```

### Фильтрация тестов:
```bash
FILTER='plus_' make test                      # Запустить только тесты операции сложения
FILTER='itmo/mult_.*_1' make test             # Запустить тесты умножения itmo, заканчивающиеся на _1
FILTER='dandolmatov' make test-verbose        # Запустить только тесты пользователя dandolmatov
FILTER='_(0|1)_' make test                    # Запустить тесты с типом округления 0 или 1
FILTER='sub_' make test                       # Запустить только тесты операции вычитания
FILTER='itmo/div_' make test-verbose          # Запустить тесты деления от пользователя itmo
```

### Комбинирование опций:
```bash
EXECUTABLE=./my_program FILTER='plus_0_' make test  # Запустить тесты сложения с типом 0 для my_program
```

## Что делать если хотите добавить свой тесты
0. Пусть каждый человек создает тесты в своей папке
1. Создайте новую ветку
```bash
git checkout -b branch_name
```
2. Создайте новую папку внутри папки tests/username (в качествее username укажите ваш ник в тг, чтобы было проще связаться если что) с именем теста. Внутри нее сделайте 2 файл: in.txt и out.txt, ввод и ожидаемый вывод соответственно
Чтобы не было коллизий названий тестов предлагаю следующую систему именования: `операция_тип-округления_номер-добавляемого-теста`
Пример: `mult_0_1`
3. Запуште все изменения, создайте пул реквест и отметьте кого-нибудь из создателей репозитория в качестве ревьюера.
**Самому мержить ПР нельзя, надо чтобы кто-нибудь провалидировал тест**

*Также предложение: давайте не плодить много простых тестов, создавайте какие-нибудь тесты, где решает тип округления, а не просто 2+2*

**По всем вопросам можете писать в тг @dandolmatov**
